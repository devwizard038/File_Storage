{"version":3,"file":"checkout-routes-63de1478.js","sources":["../../../common/resources/client/auth/guards/not-subscribed-route.tsx","../../../common/resources/client/billing/checkout/checkout-layout.tsx","../../../common/resources/client/billing/requests/use-checkout-product.ts","../../../common/resources/client/billing/pricing-table/product-feature-list.tsx","../../../common/resources/client/billing/checkout/checkout-product-summary.tsx","../../../node_modules/@paypal/paypal-js/dist/esm/paypal-js.js","../../../common/resources/client/billing/checkout/paypal/use-paypal.ts","../../../common/resources/client/billing/checkout/checkout.tsx","../../../common/resources/client/billing/checkout/stripe/checkout-stripe-done.tsx","../../../common/resources/client/billing/checkout/paypal/checkout-paypal-done.tsx","../../../common/resources/client/billing/checkout/checkout-routes.tsx"],"sourcesContent":["import {useAuth} from '../use-auth';\r\nimport {ReactElement} from 'react';\r\nimport {Navigate, Outlet} from 'react-router-dom';\r\n\r\ninterface GuestRouteProps {\r\n  children: ReactElement;\r\n}\r\nexport function NotSubscribedRoute({children}: GuestRouteProps) {\r\n  const {isLoggedIn, isSubscribed} = useAuth();\r\n\r\n  if (!isLoggedIn) {\r\n    return <Navigate to=\"/register\" replace />;\r\n  }\r\n\r\n  if (isLoggedIn && isSubscribed) {\r\n    return <Navigate to=\"/billing\" replace />;\r\n  }\r\n\r\n  return children || <Outlet />;\r\n}\r\n","import {Fragment, ReactElement, useEffect} from 'react';\r\nimport {Navbar} from '../../ui/navigation/navbar/navbar';\r\nimport {CustomMenu} from '../../menus/custom-menu';\r\nimport {LocaleSwitcher} from '../../i18n/locale-switcher';\r\nimport {removeFromLocalStorage} from '../../utils/hooks/local-storage';\r\nimport {StaticPageTitle} from '../../seo/static-page-title';\r\nimport {Trans} from '../../i18n/trans';\r\n\r\ninterface CheckoutLayoutProps {\r\n  children: [ReactElement, ReactElement];\r\n}\r\nexport function CheckoutLayout({children}: CheckoutLayoutProps) {\r\n  const [left, right] = children;\r\n\r\n  useEffect(() => {\r\n    removeFromLocalStorage('be.onboarding.selected');\r\n  }, []);\r\n\r\n  return (\r\n    <Fragment>\r\n      <StaticPageTitle>\r\n        <Trans message=\"Checkout\" />\r\n      </StaticPageTitle>\r\n      <Navbar\r\n        size=\"sm\"\r\n        color=\"transparent\"\r\n        className=\"z-10 mb-20 md:mb-0\"\r\n        textColor=\"text-main\"\r\n        logoColor=\"dark\"\r\n        darkModeColor=\"transparent\"\r\n        menuPosition=\"checkout-page-navbar\"\r\n      />\r\n      <div className=\"md:flex w-full mx-auto justify-between px-20 md:px-0 md:pt-128 md:max-w-950\">\r\n        <div className=\"hidden md:block fixed right-0 top-0 w-1/2 h-full bg-alt shadow-[15px_0_30px_0_rgb(0_0_0_/_18%)]\" />\r\n        <div className=\"md:w-400 overflow-hidden\">\r\n          {left}\r\n          <CustomMenu\r\n            menu=\"checkout-page-footer\"\r\n            className=\"text-xs mt-50 text-muted overflow-x-auto\"\r\n          />\r\n          <div className=\"mt-40\">\r\n            <LocaleSwitcher />\r\n          </div>\r\n        </div>\r\n        <div className=\"hidden md:block w-384\">\r\n          <div className=\"relative z-10\">{right}</div>\r\n        </div>\r\n      </div>\r\n    </Fragment>\r\n  );\r\n}\r\n","import {keepPreviousData, useQuery} from '@tanstack/react-query';\r\nimport {apiClient} from '../../http/query-client';\r\nimport {BackendResponse} from '../../http/backend-response/backend-response';\r\nimport {Product} from '../product';\r\nimport {useParams} from 'react-router-dom';\r\n\r\nconst endpoint = (productId: string | number) =>\r\n  `billing/products/${productId}`;\r\n\r\nexport interface FetchProductResponse extends BackendResponse {\r\n  product: Product;\r\n}\r\n\r\nexport function useCheckoutProduct() {\r\n  const {productId, priceId} = useParams();\r\n  const query = useQuery({\r\n    queryKey: [endpoint(productId!)],\r\n    queryFn: () => fetchProduct(productId!),\r\n    placeholderData: keepPreviousData,\r\n    enabled: productId != null && priceId != null,\r\n  });\r\n\r\n  const product = query.data?.product;\r\n  const price =\r\n    product?.prices.find(p => p.id === parseInt(priceId!)) ||\r\n    product?.prices[0];\r\n\r\n  return {status: query.status, product, price};\r\n}\r\n\r\nfunction fetchProduct(\r\n  productId: string | number,\r\n): Promise<FetchProductResponse> {\r\n  return apiClient.get(endpoint(productId)).then(response => response.data);\r\n}\r\n","import {Trans} from '../../i18n/trans';\r\nimport {Product} from '../product';\r\nimport {CheckIcon} from '@common/icons/material/Check';\r\n\r\ninterface FeatureListProps {\r\n  product: Product;\r\n}\r\n\r\nexport function ProductFeatureList({product}: FeatureListProps) {\r\n  if (!product.feature_list.length) return null;\r\n\r\n  return (\r\n    <div className=\"mt-32 border-t pt-24\">\r\n      <div className=\"mb-10 text-sm font-semibold\">\r\n        <Trans message=\"What's included\" />\r\n      </div>\r\n      {product.feature_list.map(feature => (\r\n        <div key={feature} className=\"flex items-center gap-10 py-6 text-sm\">\r\n          <CheckIcon className=\"text-primary\" size=\"sm\" />\r\n          <Trans message={feature} />\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","import {Trans} from '../../i18n/trans';\r\nimport {FormattedPrice} from '../../i18n/formatted-price';\r\nimport {useCheckoutProduct} from '../requests/use-checkout-product';\r\nimport {m} from 'framer-motion';\r\nimport {Skeleton} from '../../ui/skeleton/skeleton';\r\nimport {Product} from '../product';\r\nimport {Price} from '../price';\r\nimport {FormattedCurrency} from '../../i18n/formatted-currency';\r\nimport {ProductFeatureList} from '../pricing-table/product-feature-list';\r\nimport {opacityAnimation} from '../../ui/animation/opacity-animation';\r\n\r\ninterface CheckoutProductSummaryProps {\r\n  showBillingLine?: boolean;\r\n}\r\nexport function CheckoutProductSummary({\r\n  showBillingLine = true,\r\n}: CheckoutProductSummaryProps) {\r\n  const {status, product, price} = useCheckoutProduct();\r\n\r\n  if (status === 'error' || (status !== 'pending' && (!product || !price))) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-2xl mb-30\">\r\n        <Trans message=\"Summary\" />\r\n      </h2>\r\n      {status === 'pending' ? (\r\n        <LoadingSkeleton key=\"loading-skeleton\" />\r\n      ) : (\r\n        <ProductSummary\r\n          product={product!}\r\n          price={price!}\r\n          showBillingLine={showBillingLine}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface ProductSummaryProps {\r\n  product: Product;\r\n  price: Price;\r\n  showBillingLine: boolean;\r\n}\r\nfunction ProductSummary({\r\n  product,\r\n  price,\r\n  showBillingLine,\r\n}: ProductSummaryProps) {\r\n  return (\r\n    <m.div>\r\n      <div className=\"text-xl font-semibold mb-6\">{product.name}</div>\r\n      {product.description && (\r\n        <div className=\"text-sm text-muted\">{product.description}</div>\r\n      )}\r\n      <FormattedPrice\r\n        priceClassName=\"font-bold text-4xl\"\r\n        periodClassName=\"text-muted text-xs\"\r\n        variant=\"separateLine\"\r\n        price={price}\r\n        className=\"mt-32\"\r\n      />\r\n      <ProductFeatureList product={product} />\r\n      {showBillingLine && (\r\n        <div className=\"flex items-center justify-between gap-24 border-t pt-24 mt-32 font-medium\">\r\n          <div>\r\n            <Trans message=\"Billed today\" />\r\n          </div>\r\n          <div>\r\n            <FormattedCurrency value={price.amount} currency={price.currency} />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </m.div>\r\n  );\r\n}\r\n\r\nfunction LoadingSkeleton() {\r\n  return (\r\n    <m.div {...opacityAnimation} className=\"max-w-180\">\r\n      <Skeleton className=\"text-xl mb-6\" />\r\n      <Skeleton className=\"text-sm\" />\r\n      <Skeleton className=\"text-4xl mt-32\" />\r\n    </m.div>\r\n  );\r\n}\r\n","/*!\n * paypal-js v7.1.1 (2023-11-27T14:12:58.587Z)\n * Copyright 2020-present, PayPal, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction findScript(url, attributes) {\n    var currentScript = document.querySelector(\"script[src=\\\"\".concat(url, \"\\\"]\"));\n    if (currentScript === null)\n        return null;\n    var nextScript = createScriptElement(url, attributes);\n    // ignore the data-uid-auto attribute that gets auto-assigned to every script tag\n    var currentScriptClone = currentScript.cloneNode();\n    delete currentScriptClone.dataset.uidAuto;\n    // check if the new script has the same number of data attributes\n    if (Object.keys(currentScriptClone.dataset).length !==\n        Object.keys(nextScript.dataset).length) {\n        return null;\n    }\n    var isExactMatch = true;\n    // check if the data attribute values are the same\n    Object.keys(currentScriptClone.dataset).forEach(function (key) {\n        if (currentScriptClone.dataset[key] !== nextScript.dataset[key]) {\n            isExactMatch = false;\n        }\n    });\n    return isExactMatch ? currentScript : null;\n}\nfunction insertScriptElement(_a) {\n    var url = _a.url, attributes = _a.attributes, onSuccess = _a.onSuccess, onError = _a.onError;\n    var newScript = createScriptElement(url, attributes);\n    newScript.onerror = onError;\n    newScript.onload = onSuccess;\n    document.head.insertBefore(newScript, document.head.firstElementChild);\n}\nfunction processOptions(options) {\n    var sdkBaseUrl = \"https://www.paypal.com/sdk/js\";\n    if (options.sdkBaseUrl) {\n        sdkBaseUrl = options.sdkBaseUrl;\n        delete options.sdkBaseUrl;\n    }\n    var optionsWithStringIndex = options;\n    var _a = Object.keys(optionsWithStringIndex)\n        .filter(function (key) {\n        return (typeof optionsWithStringIndex[key] !== \"undefined\" &&\n            optionsWithStringIndex[key] !== null &&\n            optionsWithStringIndex[key] !== \"\");\n    })\n        .reduce(function (accumulator, key) {\n        var value = optionsWithStringIndex[key].toString();\n        key = camelCaseToKebabCase(key);\n        if (key.substring(0, 4) === \"data\" || key === \"crossorigin\") {\n            accumulator.attributes[key] = value;\n        }\n        else {\n            accumulator.queryParams[key] = value;\n        }\n        return accumulator;\n    }, {\n        queryParams: {},\n        attributes: {},\n    }), queryParams = _a.queryParams, attributes = _a.attributes;\n    if (queryParams[\"merchant-id\"] &&\n        queryParams[\"merchant-id\"].indexOf(\",\") !== -1) {\n        attributes[\"data-merchant-id\"] = queryParams[\"merchant-id\"];\n        queryParams[\"merchant-id\"] = \"*\";\n    }\n    return {\n        url: \"\".concat(sdkBaseUrl, \"?\").concat(objectToQueryString(queryParams)),\n        attributes: attributes,\n    };\n}\nfunction camelCaseToKebabCase(str) {\n    var replacer = function (match, indexOfMatch) {\n        return (indexOfMatch ? \"-\" : \"\") + match.toLowerCase();\n    };\n    return str.replace(/[A-Z]+(?![a-z])|[A-Z]/g, replacer);\n}\nfunction objectToQueryString(params) {\n    var queryString = \"\";\n    Object.keys(params).forEach(function (key) {\n        if (queryString.length !== 0)\n            queryString += \"&\";\n        queryString += key + \"=\" + params[key];\n    });\n    return queryString;\n}\nfunction createScriptElement(url, attributes) {\n    if (attributes === void 0) { attributes = {}; }\n    var newScript = document.createElement(\"script\");\n    newScript.src = url;\n    Object.keys(attributes).forEach(function (key) {\n        newScript.setAttribute(key, attributes[key]);\n        if (key === \"data-csp-nonce\") {\n            newScript.setAttribute(\"nonce\", attributes[\"data-csp-nonce\"]);\n        }\n    });\n    return newScript;\n}\n\n/**\n * Load the Paypal JS SDK script asynchronously.\n *\n * @param {Object} options - used to configure query parameters and data attributes for the JS SDK.\n * @param {PromiseConstructor} [PromisePonyfill=window.Promise] - optional Promise Constructor ponyfill.\n * @return {Promise<Object>} paypalObject - reference to the global window PayPal object.\n */\nfunction loadScript(options, PromisePonyfill) {\n    if (PromisePonyfill === void 0) { PromisePonyfill = Promise; }\n    validateArguments(options, PromisePonyfill);\n    // resolve with null when running in Node or Deno\n    if (typeof document === \"undefined\")\n        return PromisePonyfill.resolve(null);\n    var _a = processOptions(options), url = _a.url, attributes = _a.attributes;\n    var namespace = attributes[\"data-namespace\"] || \"paypal\";\n    var existingWindowNamespace = getPayPalWindowNamespace(namespace);\n    // resolve with the existing global paypal namespace when a script with the same params already exists\n    if (findScript(url, attributes) && existingWindowNamespace) {\n        return PromisePonyfill.resolve(existingWindowNamespace);\n    }\n    return loadCustomScript({\n        url: url,\n        attributes: attributes,\n    }, PromisePonyfill).then(function () {\n        var newWindowNamespace = getPayPalWindowNamespace(namespace);\n        if (newWindowNamespace) {\n            return newWindowNamespace;\n        }\n        throw new Error(\"The window.\".concat(namespace, \" global variable is not available.\"));\n    });\n}\n/**\n * Load a custom script asynchronously.\n *\n * @param {Object} options - used to set the script url and attributes.\n * @param {PromiseConstructor} [PromisePonyfill=window.Promise] - optional Promise Constructor ponyfill.\n * @return {Promise<void>} returns a promise to indicate if the script was successfully loaded.\n */\nfunction loadCustomScript(options, PromisePonyfill) {\n    if (PromisePonyfill === void 0) { PromisePonyfill = Promise; }\n    validateArguments(options, PromisePonyfill);\n    var url = options.url, attributes = options.attributes;\n    if (typeof url !== \"string\" || url.length === 0) {\n        throw new Error(\"Invalid url.\");\n    }\n    if (typeof attributes !== \"undefined\" && typeof attributes !== \"object\") {\n        throw new Error(\"Expected attributes to be an object.\");\n    }\n    return new PromisePonyfill(function (resolve, reject) {\n        // resolve with undefined when running in Node or Deno\n        if (typeof document === \"undefined\")\n            return resolve();\n        insertScriptElement({\n            url: url,\n            attributes: attributes,\n            onSuccess: function () { return resolve(); },\n            onError: function () {\n                var defaultError = new Error(\"The script \\\"\".concat(url, \"\\\" failed to load. Check the HTTP status code and response body in DevTools to learn more.\"));\n                return reject(defaultError);\n            },\n        });\n    });\n}\nfunction getPayPalWindowNamespace(namespace) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return window[namespace];\n}\nfunction validateArguments(options, PromisePonyfill) {\n    if (typeof options !== \"object\" || options === null) {\n        throw new Error(\"Expected an options object.\");\n    }\n    if (typeof PromisePonyfill !== \"undefined\" &&\n        typeof PromisePonyfill !== \"function\") {\n        throw new Error(\"Expected PromisePonyfill to be a function.\");\n    }\n}\n\n// replaced with the package.json version at build time\nvar version = \"7.1.1\";\n\nexport { loadCustomScript, loadScript, version };\n","import {useEffect, useRef, useState} from 'react';\r\nimport {loadScript} from '@paypal/paypal-js';\r\nimport {useProducts} from '@common/billing/pricing-table/use-products';\r\nimport {useSettings} from '@common/core/settings/use-settings';\r\n\r\ninterface UsePaypalProps {\r\n  productId?: string;\r\n  priceId?: string;\r\n}\r\nexport function usePaypal({productId, priceId}: UsePaypalProps) {\r\n  const {data} = useProducts();\r\n  const paypalLoadStarted = useRef<boolean>(false);\r\n  const paypalButtonsRendered = useRef<boolean>(false);\r\n  const [paypalIsLoaded, setPaypalIsLoaded] = useState(false);\r\n  const paypalElementRef = useRef<HTMLDivElement>(null);\r\n  const {\r\n    base_url,\r\n    billing: {\r\n      stripe: {enable: stripeEnabled},\r\n      paypal: {enable: paypalEnabled, public_key},\r\n    },\r\n  } = useSettings();\r\n\r\n  useEffect(() => {\r\n    if (!paypalEnabled || !public_key || paypalLoadStarted.current) return;\r\n    loadScript({\r\n      clientId: public_key,\r\n      intent: 'subscription',\r\n      vault: true,\r\n      disableFunding: stripeEnabled ? 'card' : undefined,\r\n    }).then(() => {\r\n      setPaypalIsLoaded(true);\r\n    });\r\n    paypalLoadStarted.current = true;\r\n  }, [public_key, paypalEnabled, stripeEnabled]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      !paypalIsLoaded ||\r\n      !window.paypal?.Buttons ||\r\n      !paypalElementRef.current ||\r\n      !data?.products.length ||\r\n      !productId ||\r\n      !priceId ||\r\n      paypalButtonsRendered.current\r\n    )\r\n      return;\r\n\r\n    const product = data.products.find(p => p.id === parseInt(productId));\r\n    const price = product?.prices.find(p => p.id === parseInt(priceId));\r\n\r\n    window.paypal\r\n      .Buttons({\r\n        style: {\r\n          label: 'pay',\r\n        },\r\n        createSubscription: (data, actions) => {\r\n          return actions.subscription.create({\r\n            application_context: {\r\n              shipping_preference: 'NO_SHIPPING',\r\n            },\r\n            plan_id: price?.paypal_id!,\r\n          });\r\n        },\r\n        onApprove: (data, actions) => {\r\n          actions.redirect(\r\n            `${base_url}/checkout/${productId}/${priceId}/paypal/done?subscriptionId=${data.subscriptionID}&status=success`\r\n          );\r\n          return Promise.resolve();\r\n        },\r\n        onError: e => {\r\n          location.href = `${base_url}/checkout/${productId}/${priceId}/paypal/done?status=error`;\r\n        },\r\n      })\r\n      .render(paypalElementRef.current)\r\n      .then(() => {\r\n        paypalButtonsRendered.current = true;\r\n      });\r\n  }, [productId, priceId, data, paypalIsLoaded, base_url]);\r\n\r\n  return {\r\n    paypalElementRef,\r\n    stripeIsEnabled: public_key != null && paypalEnabled,\r\n  };\r\n}\r\n","import {Navigate, useParams} from 'react-router-dom';\r\nimport {Trans} from '../../i18n/trans';\r\nimport {CheckoutLayout} from './checkout-layout';\r\nimport {CheckoutProductSummary} from './checkout-product-summary';\r\nimport {usePaypal} from './paypal/use-paypal';\r\nimport {StripeElementsForm} from './stripe/stripe-elements-form';\r\nimport {Fragment} from 'react';\r\nimport {useProducts} from '../pricing-table/use-products';\r\nimport {FullPageLoader} from '../../ui/progress/full-page-loader';\r\nimport {useSettings} from '../../core/settings/use-settings';\r\n\r\nexport function Checkout() {\r\n  const {productId, priceId} = useParams();\r\n  const productQuery = useProducts();\r\n  const {paypalElementRef} = usePaypal({\r\n    productId,\r\n    priceId,\r\n  });\r\n  const {\r\n    base_url,\r\n    billing: {stripe},\r\n  } = useSettings();\r\n\r\n  if (productQuery.isLoading) {\r\n    return <FullPageLoader screen />;\r\n  }\r\n\r\n  const product = productQuery.data?.products.find(\r\n    p => p.id === parseInt(productId!)\r\n  );\r\n  const price = product?.prices.find(p => p.id === parseInt(priceId!));\r\n\r\n  // make sure product and price exists in backend\r\n  if (!product || !price || productQuery.status === 'error') {\r\n    return <Navigate to=\"/pricing\" replace />;\r\n  }\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <Fragment>\r\n        <h1 className=\"mb-40 text-4xl\">\r\n          <Trans message=\"Checkout\" />\r\n        </h1>\r\n        {stripe.enable ? (\r\n          <Fragment>\r\n            <StripeElementsForm\r\n              productId={productId}\r\n              priceId={priceId}\r\n              submitLabel={<Trans message=\"Upgrade\" />}\r\n              type=\"subscription\"\r\n              returnUrl={`${base_url}/checkout/${productId}/${priceId}/stripe/done`}\r\n            />\r\n            <Separator />\r\n          </Fragment>\r\n        ) : null}\r\n        <div ref={paypalElementRef} />\r\n        <div className=\"mt-30 text-xs text-muted\">\r\n          <Trans message=\"You’ll be charged until you cancel your subscription. Previous charges won’t be refunded when you cancel unless it’s legally required. Your payment data is encrypted and secure. By subscribing your agree to our terms of service and privacy policy.\" />\r\n        </div>\r\n      </Fragment>\r\n      <CheckoutProductSummary />\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction Separator() {\r\n  return (\r\n    <div className=\"relative my-20 text-center before:absolute before:left-0 before:top-1/2 before:h-1 before:w-full before:-translate-y-1/2 before:bg-divider\">\r\n      <span className=\"relative z-10 bg px-10 text-sm text-muted\">\r\n        <Trans message=\"or\" />\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n","import {CheckoutLayout} from '../checkout-layout';\r\nimport {useParams, useSearchParams} from 'react-router-dom';\r\nimport {loadStripe, PaymentIntent} from '@stripe/stripe-js';\r\nimport {useEffect, useRef, useState} from 'react';\r\nimport {message} from '../../../i18n/message';\r\nimport {CheckoutProductSummary} from '../checkout-product-summary';\r\nimport {\r\n  BillingRedirectMessage,\r\n  BillingRedirectMessageConfig,\r\n} from '../../billing-redirect-message';\r\nimport {useNavigate} from '../../../utils/hooks/use-navigate';\r\nimport {apiClient} from '../../../http/query-client';\r\nimport {useSettings} from '../../../core/settings/use-settings';\r\nimport {useBootstrapData} from '../../../core/bootstrap-data/bootstrap-data-context';\r\n\r\nexport function CheckoutStripeDone() {\r\n  const {invalidateBootstrapData} = useBootstrapData();\r\n  const {productId, priceId} = useParams();\r\n  const navigate = useNavigate();\r\n  const {\r\n    billing: {stripe_public_key},\r\n  } = useSettings();\r\n\r\n  const [params] = useSearchParams();\r\n  const clientSecret = params.get('payment_intent_client_secret');\r\n\r\n  const [messageConfig, setMessageConfig] =\r\n    useState<BillingRedirectMessageConfig>();\r\n\r\n  const stripeInitiated = useRef<boolean>();\r\n\r\n  useEffect(() => {\r\n    if (stripeInitiated.current) return;\r\n    loadStripe(stripe_public_key!).then(async stripe => {\r\n      if (!stripe || !clientSecret) {\r\n        setMessageConfig(getRedirectMessageConfig());\r\n        return;\r\n      }\r\n      stripe\r\n        .retrievePaymentIntent(clientSecret)\r\n        .then(async ({paymentIntent}) => {\r\n          if (paymentIntent?.status === 'succeeded') {\r\n            await storeSubscriptionDetailsLocally(paymentIntent.id);\r\n            setMessageConfig(\r\n              getRedirectMessageConfig('succeeded', productId, priceId),\r\n            );\r\n            window.location.href = '/billing';\r\n          } else {\r\n            setMessageConfig(\r\n              getRedirectMessageConfig(\r\n                paymentIntent?.status,\r\n                productId,\r\n                priceId,\r\n              ),\r\n            );\r\n          }\r\n        });\r\n    });\r\n    stripeInitiated.current = true;\r\n  }, [\r\n    stripe_public_key,\r\n    clientSecret,\r\n    priceId,\r\n    productId,\r\n    invalidateBootstrapData,\r\n  ]);\r\n\r\n  if (!clientSecret) {\r\n    navigate('/');\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <BillingRedirectMessage config={messageConfig} />\r\n      <CheckoutProductSummary showBillingLine={false} />\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction getRedirectMessageConfig(\r\n  status?: PaymentIntent.Status,\r\n  productId?: string,\r\n  priceId?: string,\r\n): BillingRedirectMessageConfig {\r\n  switch (status) {\r\n    case 'succeeded':\r\n      return {\r\n        message: message('Subscription successful!'),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: '/billing',\r\n      };\r\n    case 'processing':\r\n      return {\r\n        message: message(\r\n          \"Payment processing. We'll update you when payment is received.\",\r\n        ),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: '/billing',\r\n      };\r\n    case 'requires_payment_method':\r\n      return {\r\n        message: message('Payment failed. Please try another payment method.'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: errorLink(productId, priceId),\r\n      };\r\n    default:\r\n      return {\r\n        message: message('Something went wrong'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: errorLink(productId, priceId),\r\n      };\r\n  }\r\n}\r\n\r\nfunction errorLink(productId?: string, priceId?: string): string {\r\n  return productId && priceId ? `/checkout/${productId}/${priceId}` : '/';\r\n}\r\n\r\nfunction storeSubscriptionDetailsLocally(paymentIntentId: string) {\r\n  return apiClient.post('billing/stripe/store-subscription-details-locally', {\r\n    payment_intent_id: paymentIntentId,\r\n  });\r\n}\r\n","import {CheckoutLayout} from '../checkout-layout';\r\nimport {useParams, useSearchParams} from 'react-router-dom';\r\nimport {useEffect, useState} from 'react';\r\nimport {message} from '@common/i18n/message';\r\nimport {CheckoutProductSummary} from '../checkout-product-summary';\r\nimport {\r\n  BillingRedirectMessage,\r\n  BillingRedirectMessageConfig,\r\n} from '../../billing-redirect-message';\r\nimport {apiClient} from '@common/http/query-client';\r\nimport {useBootstrapData} from '@common/core/bootstrap-data/bootstrap-data-context';\r\n\r\nexport function CheckoutPaypalDone() {\r\n  const {invalidateBootstrapData} = useBootstrapData();\r\n  const {productId, priceId} = useParams();\r\n  const [params] = useSearchParams();\r\n\r\n  const [messageConfig, setMessageConfig] =\r\n    useState<BillingRedirectMessageConfig>();\r\n\r\n  useEffect(() => {\r\n    const subscriptionId = params.get('subscriptionId');\r\n    const status = params.get('status');\r\n    if (subscriptionId && status === 'success') {\r\n      storeSubscriptionDetailsLocally(subscriptionId).then(() => {\r\n        setMessageConfig(\r\n          getRedirectMessageConfig('success', productId, priceId),\r\n        );\r\n        window.location.href = '/billing';\r\n      });\r\n    } else {\r\n      setMessageConfig(getRedirectMessageConfig(status, productId, priceId));\r\n    }\r\n  }, [priceId, productId, params, invalidateBootstrapData]);\r\n\r\n  return (\r\n    <CheckoutLayout>\r\n      <BillingRedirectMessage config={messageConfig} />\r\n      <CheckoutProductSummary showBillingLine={false} />\r\n    </CheckoutLayout>\r\n  );\r\n}\r\n\r\nfunction getRedirectMessageConfig(\r\n  status?: 'success' | 'error' | string | null,\r\n  productId?: string,\r\n  priceId?: string,\r\n): BillingRedirectMessageConfig {\r\n  switch (status) {\r\n    case 'success':\r\n      return {\r\n        message: message('Subscription successful!'),\r\n        status: 'success',\r\n        buttonLabel: message('Return to site'),\r\n        link: '/billing',\r\n      };\r\n    default:\r\n      return {\r\n        message: message('Something went wrong. Please try again.'),\r\n        status: 'error',\r\n        buttonLabel: message('Go back'),\r\n        link: errorLink(productId, priceId),\r\n      };\r\n  }\r\n}\r\n\r\nfunction errorLink(productId?: string, priceId?: string): string {\r\n  return productId && priceId ? `/checkout/${productId}/${priceId}` : '/';\r\n}\r\n\r\nfunction storeSubscriptionDetailsLocally(subscriptionId: string) {\r\n  return apiClient.post('billing/paypal/store-subscription-details-locally', {\r\n    paypal_subscription_id: subscriptionId,\r\n  });\r\n}\r\n","import {Route, Routes} from 'react-router-dom';\r\nimport {NotSubscribedRoute} from '../../auth/guards/not-subscribed-route';\r\nimport {Checkout} from './checkout';\r\nimport React from 'react';\r\nimport {CheckoutStripeDone} from './stripe/checkout-stripe-done';\r\nimport {CheckoutPaypalDone} from './paypal/checkout-paypal-done';\r\n\r\nexport default function CheckoutRoutes() {\r\n  return (\r\n    <Routes>\r\n      <Route\r\n        path=\":productId/:priceId\"\r\n        element={\r\n          <NotSubscribedRoute>\r\n            <Checkout />\r\n          </NotSubscribedRoute>\r\n        }\r\n      />\r\n      <Route\r\n        path=\":productId/:priceId/stripe/done\"\r\n        element={\r\n          <NotSubscribedRoute>\r\n            <CheckoutStripeDone />\r\n          </NotSubscribedRoute>\r\n        }\r\n      />\r\n      <Route\r\n        path=\":productId/:priceId/paypal/done\"\r\n        element={\r\n          <NotSubscribedRoute>\r\n            <CheckoutPaypalDone />\r\n          </NotSubscribedRoute>\r\n        }\r\n      />\r\n    </Routes>\r\n  );\r\n}\r\n"],"names":["NotSubscribedRoute","children","isLoggedIn","isSubscribed","useAuth","jsx","Navigate","Outlet","CheckoutLayout","left","right","useEffect","removeFromLocalStorage","Fragment","StaticPageTitle","Trans","Navbar","jsxs","CustomMenu","LocaleSwitcher","endpoint","productId","useCheckoutProduct","priceId","useParams","query","useQuery","fetchProduct","keepPreviousData","product","_a","price","p","apiClient","response","ProductFeatureList","CheckIcon","feature","CheckoutProductSummary","showBillingLine","status","LoadingSkeleton","ProductSummary","m","FormattedPrice","FormattedCurrency","opacityAnimation","Skeleton","findScript","url","attributes","currentScript","nextScript","createScriptElement","currentScriptClone","isExactMatch","key","insertScriptElement","onSuccess","onError","newScript","processOptions","options","sdkBaseUrl","optionsWithStringIndex","accumulator","value","camelCaseToKebabCase","queryParams","objectToQueryString","str","replacer","match","indexOfMatch","params","queryString","loadScript","PromisePonyfill","validateArguments","namespace","existingWindowNamespace","getPayPalWindowNamespace","loadCustomScript","newWindowNamespace","resolve","reject","defaultError","usePaypal","data","useProducts","paypalLoadStarted","useRef","paypalButtonsRendered","paypalIsLoaded","setPaypalIsLoaded","useState","paypalElementRef","base_url","stripeEnabled","paypalEnabled","public_key","useSettings","actions","e","Checkout","productQuery","stripe","FullPageLoader","StripeElementsForm","Separator","CheckoutStripeDone","invalidateBootstrapData","useBootstrapData","navigate","useNavigate","stripe_public_key","useSearchParams","clientSecret","messageConfig","setMessageConfig","stripeInitiated","loadStripe","getRedirectMessageConfig","paymentIntent","storeSubscriptionDetailsLocally","BillingRedirectMessage","message","errorLink","paymentIntentId","CheckoutPaypalDone","subscriptionId","CheckoutRoutes","Routes","Route"],"mappings":"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","x_google_ignoreList":[5]}