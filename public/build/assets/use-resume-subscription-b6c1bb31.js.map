{"version":3,"file":"use-resume-subscription-b6c1bb31.js","sources":["../../../common/resources/client/ui/forms/radio-group/radio.tsx","../../../common/resources/client/ui/forms/radio-group/radio-group.tsx","../../../common/resources/client/billing/billing-page/requests/use-cancel-subscription.ts","../../../common/resources/client/billing/billing-page/requests/use-resume-subscription.ts"],"sourcesContent":["import React, {ComponentPropsWithoutRef, forwardRef} from 'react';\r\nimport clsx from 'clsx';\r\nimport {mergeProps, useObjectRef} from '@react-aria/utils';\r\nimport {useController} from 'react-hook-form';\r\nimport {AutoFocusProps, useAutoFocus} from '../../focus/use-auto-focus';\r\n\r\ntype RadioSize = 'xs' | 'sm' | 'md' | 'lg' | undefined;\r\n\r\nexport interface RadioProps\r\n  extends AutoFocusProps,\r\n    Omit<ComponentPropsWithoutRef<'input'>, 'size'> {\r\n  size?: RadioSize;\r\n  value: string;\r\n  invalid?: boolean;\r\n  isFirst?: boolean;\r\n}\r\nexport const Radio = forwardRef<HTMLInputElement, RadioProps>((props, ref) => {\r\n  const {children, autoFocus, size, invalid, isFirst, ...domProps} = props;\r\n\r\n  const inputRef = useObjectRef(ref);\r\n  useAutoFocus({autoFocus}, inputRef);\r\n\r\n  const sizeClassNames = getSizeClassNames(size);\r\n\r\n  return (\r\n    <label\r\n      className={clsx(\r\n        'inline-flex gap-8 select-none items-center whitespace-nowrap align-middle',\r\n        sizeClassNames.label,\r\n        props.disabled && 'text-disabled pointer-events-none',\r\n        props.invalid && 'text-danger'\r\n      )}\r\n    >\r\n      <input\r\n        type=\"radio\"\r\n        className={clsx(\r\n          'focus-visible:ring outline-none',\r\n          'rounded-full transition-button border-2 appearance-none',\r\n          'border-text-muted disabled:border-disabled-fg checked:border-primary checked:hover:border-primary-dark',\r\n          'before:bg-primary disabled:before:bg-disabled-fg before:hover:bg-primary-dark',\r\n          'before:h-full before:w-full before:block before:rounded-full before:scale-10 before:opacity-0 before:transition before:duration-200',\r\n          'checked:before:scale-[.65] checked:before:opacity-100',\r\n          sizeClassNames.circle\r\n        )}\r\n        ref={inputRef}\r\n        {...domProps}\r\n      />\r\n      {children && <span>{children}</span>}\r\n    </label>\r\n  );\r\n});\r\n\r\nexport function FormRadio(props: RadioProps) {\r\n  const {\r\n    field: {onChange, onBlur, value, ref},\r\n    fieldState: {invalid},\r\n  } = useController({\r\n    name: props.name!,\r\n  });\r\n\r\n  const formProps: Partial<RadioProps> = {\r\n    onChange,\r\n    onBlur,\r\n    checked: props.value === value,\r\n    invalid: props.invalid || invalid,\r\n  };\r\n\r\n  return <Radio ref={ref} {...mergeProps(formProps, props)} />;\r\n}\r\n\r\nfunction getSizeClassNames(size?: RadioSize): {\r\n  circle: string;\r\n  label: string;\r\n} {\r\n  switch (size) {\r\n    case 'xs':\r\n      return {circle: 'h-12 w-12', label: 'text-xs'};\r\n    case 'sm':\r\n      return {circle: 'h-16 w-16', label: 'text-sm'};\r\n    case 'lg':\r\n      return {circle: 'h-24 w-24', label: 'text-lg'};\r\n    default:\r\n      return {circle: 'h-20 w-20', label: 'text-base'};\r\n  }\r\n}\r\n","import {\r\n  Children,\r\n  cloneElement,\r\n  forwardRef,\r\n  isValidElement,\r\n  ReactNode,\r\n  useId,\r\n} from 'react';\r\nimport clsx from 'clsx';\r\nimport {useController} from 'react-hook-form';\r\nimport {Orientation} from '../orientation';\r\nimport {RadioProps} from './radio';\r\nimport {getInputFieldClassNames} from '../input-field/get-input-field-class-names';\r\n\r\nexport interface RadioGroupProps {\r\n  children: ReactNode;\r\n  orientation?: Orientation;\r\n  size?: 'xs' | 'sm' | 'md' | 'lg';\r\n  className?: string;\r\n  label?: ReactNode;\r\n  disabled?: boolean;\r\n  name?: string;\r\n  errorMessage?: ReactNode;\r\n  description?: ReactNode;\r\n  invalid?: boolean;\r\n  required?: boolean;\r\n}\r\nexport const RadioGroup = forwardRef<HTMLFieldSetElement, RadioGroupProps>(\r\n  (props, ref) => {\r\n    const style = getInputFieldClassNames(props);\r\n    const {\r\n      label,\r\n      children,\r\n      size,\r\n      className,\r\n      orientation = 'horizontal',\r\n      disabled,\r\n      required,\r\n      invalid,\r\n      errorMessage,\r\n      description,\r\n    } = props;\r\n\r\n    const labelProps = {};\r\n    const id = useId();\r\n    const name = props.name || id;\r\n\r\n    return (\r\n      <fieldset\r\n        aria-describedby={description ? `${id}-description` : undefined}\r\n        ref={ref}\r\n        className={clsx('text-left', className)}\r\n      >\r\n        {label && (\r\n          <legend className={style.label} {...labelProps}>\r\n            {label}\r\n          </legend>\r\n        )}\r\n        <div\r\n          className={clsx(\r\n            'flex',\r\n            label ? 'mt-6' : 'mt-0',\r\n            orientation === 'vertical' ? 'flex-col gap-10' : 'flex-row gap-16'\r\n          )}\r\n        >\r\n          {Children.map(children, child => {\r\n            if (isValidElement<RadioProps>(child)) {\r\n              return cloneElement<RadioProps>(child, {\r\n                name,\r\n                size,\r\n                invalid: child.props.invalid || invalid || undefined,\r\n                disabled: child.props.disabled || disabled,\r\n                required: child.props.required || required,\r\n              });\r\n            }\r\n          })}\r\n        </div>\r\n        {description && !errorMessage && (\r\n          <div className={style.description} id={`${id}-description`}>\r\n            {description}\r\n          </div>\r\n        )}\r\n        {errorMessage && <div className={style.error}>{errorMessage}</div>}\r\n      </fieldset>\r\n    );\r\n  }\r\n);\r\n\r\ninterface FormRadioGroupProps extends RadioGroupProps {\r\n  name: string;\r\n}\r\nexport function FormRadioGroup({children, ...props}: FormRadioGroupProps) {\r\n  const {\r\n    fieldState: {error},\r\n  } = useController({\r\n    name: props.name!,\r\n  });\r\n  return (\r\n    <RadioGroup errorMessage={error?.message} {...props}>\r\n      {children}\r\n    </RadioGroup>\r\n  );\r\n}\r\n","import {useMutation} from '@tanstack/react-query';\r\nimport {apiClient} from '../../../http/query-client';\r\nimport {useTrans} from '../../../i18n/use-trans';\r\nimport {BackendResponse} from '../../../http/backend-response/backend-response';\r\nimport {toast} from '../../../ui/toast/toast';\r\nimport {message} from '../../../i18n/message';\r\nimport {User} from '../../../auth/user';\r\nimport {showHttpErrorToast} from '../../../utils/http/show-http-error-toast';\r\n\r\ninterface Response extends BackendResponse {\r\n  user: User;\r\n}\r\n\r\ninterface Payload {\r\n  subscriptionId: number;\r\n  delete?: boolean;\r\n}\r\n\r\nexport function useCancelSubscription() {\r\n  const {trans} = useTrans();\r\n  return useMutation({\r\n    mutationFn: (props: Payload) => cancelSubscription(props),\r\n    onSuccess: (response, payload) => {\r\n      toast(\r\n        payload.delete\r\n          ? trans(message('Subscription deleted.'))\r\n          : trans(message('Subscription cancelled.')),\r\n      );\r\n    },\r\n    onError: err => showHttpErrorToast(err),\r\n  });\r\n}\r\n\r\nfunction cancelSubscription({\r\n  subscriptionId,\r\n  ...payload\r\n}: Payload): Promise<Response> {\r\n  return apiClient\r\n    .post(`billing/subscriptions/${subscriptionId}/cancel`, payload)\r\n    .then(r => r.data);\r\n}\r\n","import {useMutation} from '@tanstack/react-query';\r\nimport {apiClient} from '../../../http/query-client';\r\nimport {useTrans} from '../../../i18n/use-trans';\r\nimport {BackendResponse} from '../../../http/backend-response/backend-response';\r\nimport {toast} from '../../../ui/toast/toast';\r\nimport {message} from '../../../i18n/message';\r\nimport {User} from '../../../auth/user';\r\nimport {showHttpErrorToast} from '../../../utils/http/show-http-error-toast';\r\n\r\ninterface Response extends BackendResponse {\r\n  user: User;\r\n}\r\n\r\ninterface Payload {\r\n  subscriptionId: number;\r\n}\r\n\r\nexport function useResumeSubscription() {\r\n  const {trans} = useTrans();\r\n  return useMutation({\r\n    mutationFn: (props: Payload) => resumeSubscription(props),\r\n    onSuccess: () => {\r\n      toast(trans(message('Subscription renewed.')));\r\n    },\r\n    onError: err => showHttpErrorToast(err),\r\n  });\r\n}\r\n\r\nfunction resumeSubscription({subscriptionId}: Payload): Promise<Response> {\r\n  return apiClient\r\n    .post(`billing/subscriptions/${subscriptionId}/resume`)\r\n    .then(r => r.data);\r\n}\r\n"],"names":["Radio","forwardRef","props","ref","children","autoFocus","size","invalid","isFirst","domProps","inputRef","useObjectRef","useAutoFocus","sizeClassNames","getSizeClassNames","jsxs","clsx","jsx","FormRadio","onChange","onBlur","value","useController","formProps","mergeProps","RadioGroup","style","getInputFieldClassNames","label","className","orientation","disabled","required","errorMessage","description","labelProps","id","useId","name","Children","child","isValidElement","cloneElement","FormRadioGroup","error","useCancelSubscription","trans","useTrans","useMutation","cancelSubscription","response","payload","toast","message","err","showHttpErrorToast","subscriptionId","apiClient","useResumeSubscription","resumeSubscription","r"],"mappings":"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"}